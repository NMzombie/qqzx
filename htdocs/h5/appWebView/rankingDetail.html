<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
  <title>今日排行榜</title>
  <script src="../js/flexible.js"></script>
  <link rel="stylesheet" href="ranking-detail.css">
  <script src="../js/jquery-1.10.2.js"></script>
  <script src="../js/util.js"></script>
</head>
<body>

<div class="top_menu">
  <div class="common li-active">至尊VIP<div class="bottom-line"></div></div>
  <div class="common">超级VIP<div class="bottom-line"></div></div>
</div>
<div class="ul">
  <div class="bottom_content" style="left: 0;">
    <div class="body_1">
      <div class="title-list clearfix">
        <div class="left-item t-left">排名</div>
        <div class="middle-item t-left">用户</div>
        <div class="right-item t-right">销售额</div>
      </div>
      <div class="ranking-list">
      </div>
    </div>
    <div class="body_1">
      <div class="title-list clearfix">
        <div class="left-item t-left">排名</div>
        <div class="middle-item t-left">用户</div>
        <div class="right-item t-right">销售额</div>
      </div>
      <div class="ranking-list">
        <!--<div class="item clearfix">-->
          <!--<div class="left-item t-left">-->
            <!--<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/first.png" alt="" />-->
            <!--&lt;!&ndash;<div class="ranking-num">01</div>&ndash;&gt;-->
            <!--<img class="ranking-header" src="https://timgsa.baidu.com/timg?image&quality=80" />-->
          <!--</div>-->
          <!--<div class="middle-item t-left">xxxxx</div>-->
          <!--<div class="right-item t-right">¥12,560.00</div>-->
        <!--</div>-->
        <!--<div class="item clearfix">-->
          <!--<div class="left-item t-left">-->
            <!--<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/second.png" alt="" />-->
            <!--&lt;!&ndash;<div class="ranking-num">01</div>&ndash;&gt;-->
            <!--<img class="ranking-header" src="https://timgsa.baidu.com/timg?image&quality=80" />-->
          <!--</div>-->
          <!--<div class="middle-item t-left">xxxxx</div>-->
          <!--<div class="right-item t-right">¥12,560.00</div>-->
        <!--</div>-->
        <!--<div class="item clearfix">-->
          <!--<div class="left-item t-left">-->
            <!--<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/third.png" alt="" />-->
            <!--&lt;!&ndash;<div class="ranking-num">01</div>&ndash;&gt;-->
            <!--<img class="ranking-header" src="https://timgsa.baidu.com/timg?image&quality=80" />-->
          <!--</div>-->
          <!--<div class="middle-item t-left">xxxxx</div>-->
          <!--<div class="right-item t-right">¥12,560.00</div>-->
        <!--</div>-->
        <!--<div class="item clearfix">-->
          <!--<div class="left-item t-left">-->
            <!--&lt;!&ndash;<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/first.png" alt="" />&ndash;&gt;-->
            <!--<div class="ranking-num">4</div>-->
            <!--<img class="ranking-header" src="https://timgsa.baidu.com/timg?image&quality=80" />-->
          <!--</div>-->
          <!--<div class="middle-item t-left">xxxxx</div>-->
          <!--<div class="right-item t-right">¥12,560.00</div>-->
        <!--</div>-->
        <!--<div class="item clearfix">-->
          <!--<div class="left-item t-left">-->
            <!--&lt;!&ndash;<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/first.png" alt="" />&ndash;&gt;-->
            <!--&lt;!&ndash;<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/second.png" alt="" />&ndash;&gt;-->
            <!--&lt;!&ndash;<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/third.png" alt="" />&ndash;&gt;-->
            <!--<div class="ranking-num">5</div>-->
            <!--<img class="ranking-header" src="https://timgsa.baidu.com/timg?image&quality=80" />-->
          <!--</div>-->
          <!--<div class="middle-item t-left">xxxxx</div>-->
          <!--<div class="right-item t-right">¥12,560.00</div>-->
        <!--</div>-->
        <!--<div class="item clearfix">-->
          <!--<div class="left-item t-left">-->
            <!--&lt;!&ndash;<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/first.png" alt="" />&ndash;&gt;-->
            <!--&lt;!&ndash;<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/second.png" alt="" />&ndash;&gt;-->
            <!--&lt;!&ndash;<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/third.png" alt="" />&ndash;&gt;-->
            <!--<div class="ranking-num">6</div>-->
            <!--<img class="ranking-header" src="https://timgsa.baidu.com/timg?image&quality=80" />-->
          <!--</div>-->
          <!--<div class="middle-item t-left">xxxxx</div>-->
          <!--<div class="right-item t-right">¥12,560.00</div>-->
        <!--</div>-->
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  function connectWebViewJavascriptBridge (callback) {
    if (window.WebViewJavascriptBridge) {
      callback(window.WebViewJavascriptBridge)
    } else {
      document.addEventListener('WebViewJavascriptBridgeReady', function () {
        callback(window.WebViewJavascriptBridge)
      }, false)
      if (window.WVJBCallbacks) {
        return window.WVJBCallbacks.push(callback)
      }
      window.WVJBCallbacks = [callback]
      var WVJBIframe = document.createElement('iframe')
      WVJBIframe.style.display = 'none'
      WVJBIframe.src = 'https://__bridge_loaded__'
      document.documentElement.appendChild(WVJBIframe)
      setTimeout(function () {
        document.documentElement.removeChild(WVJBIframe)
      }, 0)
    }
  }
  // 注册回调函数，第一次连接时调用 初始化函数
  // bridge.init 只有android需要调用初始化，可以使用Object.keys(bridge) 打开查看对象，ios没有init方法
  connectWebViewJavascriptBridge(function (bridge) {
    try {
      bridge.init(function (message, responseCallback) {
        console.log('JS got a message', message)
        var data = {
          'Javascript Responds': 'CMYH!'
        }
        console.log('JS responding with', data)
        responseCallback(data)
      })
    } catch (e) {
      console.log(e)
    }
  })
  let baseUrl = ''
  getQueryString('dev') ? baseUrl = 'http://qqzx.xc2018.com.cn' : baseUrl = 'http://api.wchoosemall.com'
  let token = 'bdfb862ec2df4a358cb24193711574'
  let test = []
  // 总监排行（至尊）
  const extremeData = {
    activityId: getQueryString('activityId'),
    level: 30
  }
  $.ajax({
    type: 'post',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    url: `${baseUrl}/doc/api/common/auth/memberSales/getItemRanking.json?token=${token}`,
    data: `data=${JSON.stringify(extremeData)}`,
    success: (res) => {
      const extremeList = res.data.list
      for (let i = 0; i < 10; i++) {
        test.push(extremeList[0])
      }
      for (let i = 0; i < extremeList.length; i++) {
        const fir = `<div class="item clearfix"><div class="left-item t-left">`
        let sec = ''
        if (i === 0) {
          sec = `<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/first.png" alt="" />`
        } else if (i === 1) {
          sec = `<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/second.png" alt="" />`
        } else if (i === 2) {
          sec = `<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/third.png" alt="" />`
        } else if (i >= 3 && i < 9) {
          sec = `<div class="ranking-num">0${i + 1}</div>`
        } else{
          sec = `<div class="ranking-num">${i + 1}</div>`
        }
        const thi = `<img class="ranking-header" src="${extremeList[i].avatar}" /></div><div class="middle-item t-left">${extremeList[i].nickName}</div><div class="right-item t-right">¥${priceFormat(extremeList[i].salesPrice)}</div></div>`
        $('.ranking-list').eq(0).append(fir + sec + thi)
      }
    }
  })
  // 经理排行（超级）
  const superData = {
    activityId: getQueryString('activityId'),
    level: 20
  }
  $.ajax({
    type: 'post',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    url: `${baseUrl}/doc/api/common/auth/memberSales/getItemRanking.json?token=${token}`,
    data: `data=${JSON.stringify(superData)}`,
    success: (res) => {
      const superList = res.data.list
      for (let i = 0; i < superList.length; i++) {
        const fir = `<div class="item clearfix"><div class="left-item t-left">`
        let sec = ``
        if (i === 0) {
          sec = `<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/first.png" alt="" />`
        } else if (i === 1) {
          sec = `<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/second.png" alt="" />`
        } else if (i === 2) {
          sec = `<img class="ranking-img" src="http://file.wchoosemall.com/platform/manager/pic/third.png" alt="" />`
        } else if (i >= 3 && i < 9) {
          sec = `<div class="ranking-num">0${i + 1}</div>`
        } else{
          sec = `<div class="ranking-num">${i + 1}</div>`
        }
        const thi = `<img class="ranking-header" src="${superList[i].avatar}" /></div><div class="middle-item t-left">${superList[i].nickName}</div><div class="right-item t-right">¥${priceFormat(superList[i].salesPrice)}</div></div>`
        $('.ranking-list').eq(1).append(fir + sec + thi)
      }
    }
  })
  //console.log("left -右滑",(parseInt($('.bottom_content')[0].style.left)));
  // tab切换功能（滑动）
  $('.bottom_content')[0].style.left = "0%"
  var startX = '',disX =''
  $('.top_menu').on('click','.common',function(){
    var index = $(this).index()
    $('.bottom_content').css('left','-' + index * 100 + '%')
    $('.top_menu .common').eq(index).addClass('li-active').siblings().removeClass('li-active')
  })
  $('.bottom_content').on('touchstart','.body_1',function(e){
    startX = e.originalEvent.changedTouches[0].clientX
  })
  $('.bottom_content').on('touchmove','.body_1',function(e){
    e.stopPropagation()
  })
  $('.bottom_content').on('touchend','.body_1',function(e){
    disX = e.originalEvent.changedTouches[0].clientX - startX
    var leftNum = parseInt($('.bottom_content')[0].style.left)
    if(disX > 0 && disX > 100) {
      if(leftNum <= -100) {
        $('.bottom_content')[0].style.left = leftNum + 100 + "%"
        var order = -parseInt($('.bottom_content')[0].style.left)/100
        $('.top_menu .common').eq(order).addClass('li-active').siblings().removeClass('li-active')
      }
    } else if(disX < 0 && disX < -100) {
      if ((-parseInt($('.bottom_content')[0].style.left))/100 === 1) {
        return
      }
      if(leftNum >= -100) {
        $('.bottom_content')[0].style.left = leftNum - 100 + "%"
        var order = (-parseInt($('.bottom_content')[0].style.left))/100
        $('.top_menu .common').eq(order).addClass('li-active').siblings().removeClass('li-active')
      }
    }
  })
</script>
</body>
</html>
